/* ===== Light Theme (Hygge) ===== */
:root{
    --bg:#faf8f5;--panel:#f5f1eb;--ink:#3d352b;--muted:#8b7355;--ok:#7a9c6c;--bad:#c97d60;--accent:#d4a574
}

/* ===== Dark Theme ===== */
[data-theme="dark"]{
    --bg:#0f172a;--panel:#111827;--ink:#e5e7eb;--muted:#94a3b8;--ok:#10b981;--bad:#ef4444;--accent:#38bdf8
}

*{box-sizing:border-box}
html,body{height:100%}

/* Light theme body */
body{
    margin:0;
    font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;
    background:radial-gradient(1200px 800px at 20% 0%,#ede6d8 0%,var(--bg) 40%,#f5f1eb 100%);
    color:var(--ink);
    display:grid;
    grid-template-rows:auto 1fr auto;
    min-height:100vh;
    gap:12px;
    padding:16px;
    transition:background 0.3s ease,color 0.3s ease;
}

/* Dark theme body */
[data-theme="dark"] body{
    background:radial-gradient(1200px 800px at 20% 0%,#111827 0%,var(--bg) 40%,#0b1022 100%);
}

header,footer{display:flex;align-items:center;justify-content:space-between;position:relative}
#stats span{margin-right:12px;color:var(--muted);font-weight:500}

/* Theme toggle */
#themeToggle{
    position:absolute;
    left:50%;
    transform:translateX(-50%);
    z-index:10;
}

.theme-switch{
    position:relative;
    display:inline-block;
    width:60px;
    height:30px;
    cursor:pointer;
}

.theme-switch input{
    opacity:0;
    width:0;
    height:0;
}

.slider{
    position:absolute;
    cursor:pointer;
    top:0;
    left:0;
    right:0;
    bottom:0;
    background-color:var(--panel);
    border:1px solid var(--muted);
    transition:.4s;
    border-radius:30px;
}

.slider:before{
    position:absolute;
    content:"";
    height:22px;
    width:22px;
    left:4px;
    bottom:3px;
    background-color:var(--ink);
    transition:.4s;
    border-radius:50%;
    z-index:2;
}

.theme-switch input:checked + .slider{
    background-color:var(--accent);
}

.theme-switch input:checked + .slider:before{
    transform:translateX(30px);
}

/* Light theme slider */
.slider:before{
    background-color:#faf8f5;
}

[data-theme="dark"] .slider:before{
    background-color:#1f2937;
}

/* Sun and Moon Icons */
.sun-icon, .moon-icon{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    font-size:14px;
    transition:opacity 0.3s, transform 0.4s;
    z-index:1;
    line-height:1;
}

.sun-icon{
    left:8px;
    opacity:1;
}

.moon-icon{
    right:8px;
    opacity:0;
}

/* Dark mode: show moon, hide sun */
.theme-switch input:checked + .slider .sun-icon{
    opacity:0;
    transform:translateY(-50%) scale(0.5);
}

.theme-switch input:checked + .slider .moon-icon{
    opacity:1;
    transform:translateY(-50%) scale(1);
}

/* Light mode: show sun, hide moon */
.theme-switch input:not(:checked) + .slider .sun-icon{
    opacity:1;
    transform:translateY(-50%) scale(1);
}

.theme-switch input:not(:checked) + .slider .moon-icon{
    opacity:0;
    transform:translateY(-50%) scale(0.5);
}

main{
    max-width:860px;
    margin:0 auto;
    background:rgba(245,241,235,.8);
    border:1px solid #d4c4b0;
    border-radius:16px;
    padding:24px;
    width:100%;
    box-shadow:0 2px 8px rgba(61,53,43,.08);
    transition:background 0.3s ease,border-color 0.3s ease,box-shadow 0.3s ease;
}

[data-theme="dark"] main{
    background:rgba(17,24,39,.6);
    border:1px solid #1f2937;
    box-shadow:none;
}

#controls{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-bottom:12px}
#controls label{display:flex;align-items:center;gap:6px;color:var(--muted);font-size:14px}
#controls input, #controls select, #controls textarea{
    background:#faf8f5;
    color:var(--ink);
    border:1px solid #d4c4b0;
    border-radius:8px;
    padding:8px;
    font-size:14px;
    transition:background 0.3s ease,border-color 0.3s ease,color 0.3s ease;
    font-family:inherit;
}

#controls input, #controls select{
    cursor:pointer;
}

#controls select{
    min-width:200px;
    -webkit-appearance:none;
    -moz-appearance:none;
    appearance:none;
    padding-right:8px;
}

#controls textarea{
    width:100%;
    resize:vertical;
    min-height:80px;
    cursor:text;
    font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
}

#customTextContainer{
    width:100%;
    margin-top:8px;
}

#customTextContainer label{
    display:flex;
    flex-direction:column;
    gap:6px;
    width:100%;
}

[data-theme="dark"] #controls input, [data-theme="dark"] #controls select, [data-theme="dark"] #controls textarea{
    background:#0b1329;
    border:1px solid #1f2937;
}

#controls select option{
    background:var(--panel);
    color:var(--ink);
}

#controls select optgroup{
    font-weight:600;
    color:var(--muted);
}

button{
    background:#ede6d8;
    color:var(--ink);
    border:1px solid #d4c4b0;
    border-radius:10px;
    padding:10px 14px;
    cursor:pointer;
    font-size:14px;
    transition:all 0.2s;
}

button:hover{
    border-color:#c9b89b;
    background:#e8ded0;
}

[data-theme="dark"] button{
    background:#111827;
    border:1px solid #1f2937;
}

[data-theme="dark"] button:hover{
    border-color:#334155;
    background:#1a1f2e;
}

button:active{transform:scale(0.98)}

#textToType{
    font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
    font-size:22px;
    line-height:1.8;
    background:#faf8f5;
    border:1px solid #d4c4b0;
    border-radius:12px;
    padding:20px;
    min-height:160px;
    transition:transform .08s,background 0.3s ease,border-color 0.3s ease;
    word-wrap:break-word;
    box-shadow:inset 0 1px 3px rgba(61,53,43,.06);
}

[data-theme="dark"] #textToType{
    background:#0b1329;
    border:1px solid #1f2937;
    box-shadow:none;
}

.token{opacity:.55;transition:opacity 0.2s}
.token.done{opacity:1}
.token.correct{color:var(--ok)}
.token.wrong{color:var(--bad);text-decoration:underline}

/* Light theme current token */
.token.current{
    background:rgba(212,165,116,.15);
    border-radius:6px;
    padding:2px 1px;
    opacity:1;
    animation:pulse 1.5s ease-in-out infinite;
}

@keyframes pulse{
    0%,100%{background:rgba(212,165,116,.15)}
    50%{background:rgba(212,165,116,.25)}
}

/* Dark theme current token */
[data-theme="dark"] .token.current{
    background:rgba(56,189,248,.12);
    animation:pulseDark 1.5s ease-in-out infinite;
}

@keyframes pulseDark{
    0%,100%{background:rgba(56,189,248,.12)}
    50%{background:rgba(56,189,248,.2)}
}

.shake{animation:shake 0.15s}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-3px)}75%{transform:translateX(3px)}}
#hint{margin:10px 0 6px;color:var(--muted);font-size:13px}
#best{margin-top:10px;color:var(--muted);font-size:14px}
#best span{color:var(--accent);font-weight:600}

@media (max-width: 768px) {
    #textToType{font-size:18px;padding:16px}
    #controls{flex-direction:column;align-items:stretch}
    #controls label{flex-direction:column;align-items:flex-start}
    #controls input, #controls select, #controls textarea{width:100%}
    button{width:100%}
    #themeToggle{position:static;transform:none;margin:10px 0}
    header{flex-direction:column;gap:10px}
    #stats{order:3}
}